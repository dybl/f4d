# f4d 人脸重建

![](https://img.shields.io/badge/build-crossplatform-ff69b4.svg)
![](https://img.shields.io/badge/release-v0.1.0-0f9d58.svg)
![](https://img.shields.io/badge/license-GPLv3.0-253bd8.svg)

## features 特性


> 计算机处理人脸时，有时会依赖一种所谓的**3D Morphable Model(3DMMs)**。3DMM是三维人脸形状和纹理的有力统计模型，也是从单个图像重建面部形状的方法。该方法由**Blanz**在99年首次提出，往后的改进通常是基于他们的工作。这种方法有一个关于人脸模型的”先验知识“，即可形变模型。这一模型代表了一个平均人脸，但同时也包含了与这一平均值常见的偏差模式信息。因此不管人脸处于什么角度，都能得到较完整的人脸。

> 鉴于这种相关性，计算机可以在不将有关你脸部全部表征信息都存储下来的情况下，只列出几百个数字描述你的脸与平均人脸的偏差，就能够生成专属于你的面部图像了。不仅如此，这些偏差还包括大致的年龄、性别和脸部长度等参数。

- 但是，这样也有一个问题。因为世界上的人脸千变万化，要将所有人脸与平均人脸的偏差都存储下来，3DMM 需要集成许多面部的信息。目前为止所采用的方法是扫描大量人脸，然后人工仔细标记所有的特征。也因此，目前较好的模型也只是基于几百张人脸——大部分还都是白人，而且模型在模仿不同年龄和种族人脸方面的能力十分有限。

| 常见人脸模型 | ... |
| --- | --- |
| BFM  | Basel Face Model |
| SFM | Surrey Face Model |
| Fwh    | FaceWarehouse  |
| LSFM | Large Scale Facial Model |

- **其中，LSFM可能是如今最精准的模型**
- BFM比较容易获取，很多人用它进行实验
- SFM的开源框架也为社区做出了巨大贡献
- 同时，浙大团队的FaceWarehouse以及一系列相关的文章都值得一读。

> 从单个图像中提取三维面部形状的一般问题是一个难以解决的问题，没有使用任何统计先验的形状和纹理的脸。也就是说，如果不事先知道物体的形状，就会发现问题中存在固有的模糊性。
  
- 图像中位置的像素强度是物体的**基础形状**、**表面反射率**和**正常特征**、**相机参数**以及**场景照明**和其他物体的排列组合的结果。

> 因此，对于这个问题，可能有无限的解决方案。


- 3DMM由三个参数模型组成:形状、录像和纹理模型

> 随着新的3D传感器的出现，许多三维人脸数据集已经被收集，既包括中性，也包含有表情的面孔。但是，所有数据集都是在受控条件下捕获的。因此，即使能从这些数据中学习到强大的3D人脸模型，也很难建立足够的统计纹理模型来重建在无约束条件下捕获的人脸(“in-the-wild”)。在本文中，我们通过结合一个强有力的面部形态的统计模型，将面部轮廓的特征和表达方式结合在一起，提出了一种“在野外”的3DMM，并采用了“In -the-wild”纹理模型。我们证明了这种“in-thewild”纹理模型的使用极大地简化了拟合过程，因为没有必要对光照参数进行优化。

> 完成重建后，我们可获得人脸三维网格、模型在图像中的位置，以及当前人脸的形状特征参数和blendshape表情参数。

> 基于以上信息，可以实现各种有意思的效果，下面根据这几组参数分别举一些例子。

> 3DMM模型，也就是将三维的人脸按照shape，expression，texture等各个维度进行分离并降维表示，随后线性叠加表示三维模型，它要解决的就是要分别求取相关的参数，通常使用inverse rendering的思路，也就是从二维图像重建3维，然后从3维投影回2维计算误差。

- 建立三维人脸的统计模型，再将该模型拟合到输入的二维人脸图像上，利用拟合参数实现三维人脸的重建。

- 这类方法基本都是基于Blanz和Vetter提出的三维形变模型（3D Morphable Model，简称3DMM）

- 由于3DMM采用主成分分析（PCA）方法构建统计模型，而PCA本质上是一种低通滤波，所以这类方法在恢复人脸的细节特征方面效果仍然不理想。此外，上述两类方法在重建过程中对每幅图像都需要求解优化问题，因而实时性较差。

> PCA的核心思想是在进行投影之后尽量多的保留原始数据的主要信息，降低数据的冗余信息，以利于后续的识别。LDA的核心思想是最大化类间差异，最小化类内差异，即保证同一个人的不同人脸图像在投影之后聚集在一起，不同人的人脸图像在投影之后被用一个大的间距分开。

- PCA和LDA最后都归结于求解矩阵的特征值和特征向量，这有成熟的数值算法可以实现。

<!--
### WorkFlow

- 输入二维人脸图像

- 使用dlib的正面人脸检测器

- 进行关键点检测和角度估计

- 构建初步的全局PCA

- 自动删去错误的对应`1

- 从而提取人脸特征重建出三维obj模型

- 再将纹理信息映射至该模型
-->

### TODO 后续

## exists problem 存在的问题

- 1、光线问题

> 光照一直是机器视觉的老问题，对于人脸识别来说更是明显，由于人脸是一个3D的立体物，在不同方向和角度的光照下会增强或减弱脸部的某些特征，这就导致了机器读取的信息有偏差导致识别失败。


- 2、表情

> 姿态问题涉及头部在三维垂直坐标系中绕三个轴的旋转造成的面部变化，其中垂直于图像平面的两个方向的深度旋转会造成面部信息的部分缺失。而目前大多数算法主要是对于正面且准正的人脸来识别，如果当发生俯仰或者左右倾斜比较厉害时，算法的识别率会急剧下降。面部幅度较大的哭、笑、愤怒等表情变化同样影像着面部识别的准确率。

- 3、遮挡问题

> 由于人脸识别需要完整采集人脸的信息，而如果在有遮挡的情况下无法收集完整信息从而导致无法识别。拿IPhone X举例子，平时正常情况下拿起手机即可解锁，而在戴口罩时就会完全失效。其原因正是被采集出来的人脸图像有不完整，从而影响了后面的特征提取与识别，导致人脸检测算法的失效。

- 4、人脸相似性

> 全球人口众多，除了亲子关系长相相似，甚至有许多毫无血缘关系的人也有相似，这点对于利用人脸进行定位是有利的，但是对于利用人脸区分人类个体是不利的。

- 5、样本缺乏

> 基于统计学习的人脸识别算法是目前人脸识别领域中的主流算法，但是统计学习方法需要大量的训练。由于人脸图像在高维空间中的分布是一个不规则的流形分布，能得到的样本只是对人脸图像空间中的一个极小部分的采样，如何解决小样本下的统计学习问题有待进一步的研究。

## License 许可

```sh
Copyright 2019 dybl

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```
